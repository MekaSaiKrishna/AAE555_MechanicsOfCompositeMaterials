function [Qd] = findQbar(Q,t)

Q11 = Q(1,1);
Q12 = Q(1,2);
Q22 = Q(2,2);
Q66 = Q(3,3);

c = cosd(t); s = sind(t);

Q11d = c^4*Q11 + 2*(c^2*s^2)*(Q12+2*Q66) + s^4*Q22;
Q12d = c^2*s^2*(Q11 + Q22 - 4*Q66) + (c^4 + s^4)*Q12;
Q16d = s*c*(c^2*(Q11-Q12-2*Q66) + s^2*(Q12-Q22+2*Q66));
Q22d = (s^4*Q11) + 2*(c^2*s^2)*(Q12+2*Q66) + c^4*Q22;
Q26d = s*c*(s^2*(Q11 - Q12 - 2*Q66) + c^2*(Q12 - Q22 + 2*Q66));
Q66d = c^2*s^2*(Q11-2*Q12+Q22) + ((s^2-c^2)^2)*Q66;
Qd = [Q11d, Q12d, Q16d;
      Q12d, Q22d, Q26d;
      Q16d, Q26d, Q66d];

end